### 1. Attack Simulation

I am going to simulate a brute force attack by attemting RDP connection to my Windows Server (Domain Controller) with wrong credentials from my host PC which is on a different network. 

<img width="572" height="661" alt="image" src="https://github.com/user-attachments/assets/b8cce01f-26f2-4d74-bfc8-03f12d350335" />

The logs are comming in on QRadar (`User Login Failure`) below with the source ip `192.168.178.1` which belongs to my host PC (Attacker) and a destination ip `10.10.1.10` which belongs to my Windows Server.

<img width="1819" height="90" alt="image" src="https://github.com/user-attachments/assets/93956a78-bb99-436d-b24a-f884ace6f610" />

All i need to do is repeat the process 10 times wihtin 5 minutes and an offense get triggered which activates the custom action for the automated response.

### 2. Automated Response

After trying to login with wrong credentials at least 10 times, the rule I created triggered an offense and activated the custom action response which automatically added the malicious IP address to the qradar_blocklist on the firewall which effectively blocked any further connections to any device in my *LAN* network.

The following image shows the event that triggered the offense `Failure Audit: An account failed to log on` and also events on QRadar from our firewall within the same minute showing SSH connections from QRadar `10.10.1.110` to the Firewall `10.10.1.1` to run the command to add the malicious ip to the block list with the user `qradar_usr` as specified in the custom action bash script.
<img width="1707" height="164" alt="image" src="https://github.com/user-attachments/assets/1af9fc8b-741a-49ee-a8fd-fbe435506175" />

The rule `Potential Brute Force Attack` is listed among the matching rules for the event. This triggered the rule response I configured which is to add the associated source ip to the `qradar_blocklist`.
<img width="1251" height="353" alt="image" src="https://github.com/user-attachments/assets/77e3cfc9-1c7a-49d5-8a7b-36b3779fa883" />

The image below shows the logs of the action taken on the firewall at `23:37:52 (11:37:52 PM)` which is just over 10 seconds from the event time of `11:37:41 PM` which triggered the offense.
<img width="1142" height="151" alt="image" src="https://github.com/user-attachments/assets/968efcf8-f534-4e6d-b623-ec64e6f02f53" />

Now when I try to connect to the Windows Server `10.10.1.10` using RDP, my connection gets blocked.

<img width="728" height="337" alt="image" src="https://github.com/user-attachments/assets/b11c8d0a-3ded-4cbe-80bb-be47427f5c89" />

Also, when I try to connect to my QRadar console `10.10.1.110`

<img width="548" height="443" alt="image" src="https://github.com/user-attachments/assets/d722cf3f-66df-490d-9cdc-06546015e0f9" />

The firewall logs below show the blocked connections.

<img width="1133" height="139" alt="image" src="https://github.com/user-attachments/assets/d0b4a519-2a6f-4c44-afc7-af3858afc092" />
