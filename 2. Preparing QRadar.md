1. Test Connection

  SSH into pfSense from your QRadar console cli using the following command:
  
  ``` text
  ssh -i ~/.ssh/id_rsa qradar_usr@10.10.1.1
  ```
  
  replace `~/.ssh/id_rsa` with your QRadar private key path, `qradar_usr` with the user you created and `10.10.1.1` with the ip of your pfSense firewall
  
  You would most likely get the following error:
  
  ```text
  [root@qracon ~]# ssh -i ~/.ssh/id_rsa.pub qradar_usr@10.10.1.1
  No ED25519 host key is known for 10.10.1.1 and you have requested strict checking.
  Host key verification failed.
  ```
  
  This means QRadar does not trust pfSense's SSH host key yet. You can fix that by running the following command:
  
  ``` text
  ssh-keyscan -t ed25519 <pfSense ip here> >> ~/.ssh/known_hosts
  ```
  replace `<pfSense ip here>` with your pfSense ip address.
  
  <img width="630" height="58" alt="image" src="https://github.com/user-attachments/assets/97466524-342b-49ce-8367-c69aabe1dbe8" />
  
  The output above shows the command ran successfully.
  
  You can try to ssh again now and it should work fine.
  
  <img width="686" height="54" alt="image" src="https://github.com/user-attachments/assets/4a7b0762-dbcf-4ee1-abe7-57897757c0ca" />
  
  Now that ssh connection is working fine, we can move on to testing the command to add ip to block list and remove ip from block list.

2. Manual Test for adding ip address to blocklist

  Run the following command to add `1.2.3.4` to the ip block list:

  ```text
  sudo pfctl -t qradar_blocklist -T add 1.2.3.4
```
