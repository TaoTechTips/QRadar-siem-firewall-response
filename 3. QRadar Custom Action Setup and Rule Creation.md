### Phew! We made it!

It is about to get interesting.

### 1. Create Custom Action 

  Login to your QRadar UI. 

  Navigate to Admin > Custom Actions > Define Actions

  <img width="136" height="154" alt="image" src="https://github.com/user-attachments/assets/2e40c122-d987-435b-97fb-d1ce6381ba07" />

  Click on Add to create a new Custom Action

  <img width="1018" height="238" alt="image" src="https://github.com/user-attachments/assets/0e346805-dd29-46cd-a12a-7b484d9e6c40" />

  <img width="537" height="591" alt="image" src="https://github.com/user-attachments/assets/c8edf5f6-b674-46bd-aa25-10e4af1c172e" />

  Give your custom action a name and description.

  Set the interpreter to Bash and upload the script. (`block_ip_pfsense.sh`)

  Scroll down

  Create a new Script Parameter (`Source IP`)
  Select Network Event Property and choose the `sourceip` property since we are using the source ip of the offense as our malicious ip.

  <img width="528" height="594" alt="image" src="https://github.com/user-attachments/assets/ba4004e7-75f7-4973-86e2-394ef59c025b" />  

  <img width="490" height="102" alt="image" src="https://github.com/user-attachments/assets/9a185c50-03e0-4263-a32e-3cf348e792b8" />

  Click on the `Save` button.

  <img width="402" height="142" alt="image" src="https://github.com/user-attachments/assets/b6fcf599-ad16-44be-b40a-212cf4569e95" />

  Let us head to the `Admin` tab to deploy our change.

  `Admin` > `Deploy Changes`

  <img width="1665" height="576" alt="image" src="https://github.com/user-attachments/assets/4dd9e67e-b905-4e04-a525-b56bb0c5f085" />

  After the changes have been deployed, our custom action is now ready to be used in a rule response.
  
  You can also test your custom action.

  Navigate back to the custom actions window and select the custom action then click on `Test Execution`.

  <img width="743" height="231" alt="image" src="https://github.com/user-attachments/assets/ea46c910-cf27-4e7c-8afb-14c0c26fe72d" />

  _NB: you would have to use a fixed property for `source ip` in your test since there is no actual event_

### 2. Create QRadar Rule



### References 
https://www.ibm.com/docs/en/qsip/7.5?topic=tasks-adding-custom-actions
